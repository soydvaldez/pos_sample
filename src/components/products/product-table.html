<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <!-- <script type="module" src="./js/views/index.js" defer></script> -->
    <!-- <script type="module" src="./js/views/product.controller.js" defer></script> -->
    <!-- <script type="module" src="./js/views/paginator.controller.js" defer></script> -->
    <link rel="stylesheet" href="./css/product.css">
</head>

<body>
    <header style="position: sticky; top: 0px;">
        <nav>
            <ul>
                <li><a href="#">Products</a></li>
                <li><a href="#">Registrar</a></li>
            </ul>
        </nav>
    </header>
    <section style="height: 250px; width: 100%;">
        <div style="width: 90%; margin: 0 auto; text-align: center;">
            <h3 style="font-family: 'Courier New', Courier, monospace;">Módulo de Administración</h3>
        </div>
        <div style="width:100%; margin: 0 auto; text-align: center;">
            <button style="height: 150px; width: 20.3%; border: 1px solid #ccc;">Ventas</button>
            <button style="height: 150px; width: 20.3%; border: 1px solid #ccc;">Pedidos</button>
            <button style="height: 150px; width: 20.3%; border: 1px solid #ccc;">Registro</button>
            <button style="height: 150px; width: 20.3%; border: 1px solid #ccc;">Venta Diaria</button>
        </div>
    </section>
    <section>
        <!-- Notificacion de guardado -->
        <!-- position: sticky top: 20px -->
        <!-- <div class="notification">
            <span>Se ha guardado el elemento</span>
        </div> -->
        <!-- <div class="options-container">
            <button class="btn-save">Actualizar</button>
        </div> -->
        <div class="container_products-table">
            <div style="background-color: black; opacity: .8; text-align: center; ">
                <span style="font-family: 'Courier New', Courier, monospace ;color:white; font-size: 2.4rem;">
                    Detalle del Producto
                </span>
            </div>
            <div class="div-container_form">
                <form class="form-details">
                    <div class="form-detail-product__img" style="text-align: center;">
                        <img style="height: 300px; cursor: pointer;"
                            src="../../../public/funko-pop-5979786_640-removebg-preview.png">
                    </div>
                    <div class="form-detail-product">
                        <label for="nombre">
                            <span>Nombre*</span>
                            <input type="text" name="nombre" id="nombre" required />
                        </label>
                        <label for="descripcion">
                            <span>Descripcion</span>
                            <textarea name="descripcion" id="descripcion" cols="50" rows="5"></textarea>
                        </label>
                        <label for="precio">
                            <span>Precio Venta*</span>
                            <input type="number" name="precio" id="precio" min="0" max="10000" required />
                        </label>
                        <label for="precio">
                            <span>Precio*</span>
                            <input type="number" name="precio" id="precio" min="0" max="10000" required />
                        </label>
                        <label for="stock">
                            <span>Stock*</span>
                            <input type="number" name="stock" id="stock" min="0" required />
                        </label>
                    </div>
                    <div class="form-detail-product__footer">
                        <input type="submit" value="Actualizar">
                    </div>
                    <div class="form-detail-product__footer">
                        <button type="submit">Limpiar</button>
                    </div>
                </form>
            </div>
            <table>
                <thead style="position: sticky; top: 0px;">
                    <tr>
                        <th>No</th>
                        <th>Nombre</th>
                        <th>Descripcion</th>
                        <th>Precio</th>
                        <th>Stock</th>
                        <th style="width: 30px;">Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    <tr classitem="1">
                        <td name=" id">1</td>
                        <td name="nombre">Funko Pop - Tony Stark</td>
                        <td name="descripcion">Figura coleccionable de 15 cm</td>
                        <td name="precio">300</td>
                        <td name="stock">20</td>
                        <td class="simulate-action" name="actions">
                            <i class="glyphicon glyphicon-menu-down custom"></i>
                        </td>
                    </tr>
                    <tr classitem="2">
                        <td name="id">2</td>
                        <td name="nombre">Funko Pop - Rocket</td>
                        <td name="descripcion">Figura coleccionable de 15 cm</td>
                        <td name="precio">550</td>
                        <td name="stock">10</td>
                        <td colspan="2" name="actions" class="actions">
                            <i class="glyphicon glyphicon-menu-down custom">
                            </i>
                        </td>
                    </tr>
                    <tr classitem="3">
                        <td name="id">3</td>
                        <td name="nombre">Funko Pop - Pantera Negra</td>
                        <td name="descripcion">Figura coleccionable de 15 cm</td>
                        <td name="precio">300</td>
                        <td name="stock">20</td>
                        <td colspan="2" name="actions" class="actions">
                            <i class="glyphicon glyphicon-menu-down custom">
                            </i>
                        </td>
                    </tr>
                    <tr classitem="4">
                        <td name="id">4</td>
                        <td name="nombre">Funko Pop - Evee</td>
                        <td name="descripcion">Figura coleccionable de 15 cm</td>
                        <td name="precio">300</td>
                        <td name="stock">20</td>
                        <td colspan="2" name="actions" class="actions">
                            <i class="glyphicon glyphicon-menu-down custom">
                            </i>
                        </td>
                    </tr>
                    <tr classitem="5">
                        <td name="id">5</td>
                        <td name="nombre">Funko Pop - Capitan America</td>
                        <td name="descripcion">Figura coleccionable de 15 cm</td>
                        <td name="precio">600</td>
                        <td name="stock">5</td>
                        <td colspan="2" name="actions" class="actions">
                            <i class="glyphicon glyphicon-menu-down custom">
                            </i>
                        </td>
                    </tr>

                </tbody>
            </table>
        </div>
        <style>
            .div-container_form {
                border: 1px solid #ccc;
                width: 100%;
            }

            .form-details {
                display: grid;
                justify-items: center;

                grid-template-columns: repeat(2, 1fr);
                grid-template-rows: 1fr;
                grid-column-gap: 10px;
                grid-row-gap: 50px;

                /* Desactiva la propiedad que centra los divs */
                text-align: left;
                height: 500px;

                border: 1px solid #ccc;
                width: 99%;
                height: 100%;
                margin: 5px auto;
            }

            form {
                /* margin-bottom: 1000px; */
            }

            form label {
                margin-left: 20px;
            }

            .form-details label[for="descripcion"] {
                display: inline-block;
                width: 95%;
            }

            textarea {
                font-weight: normal;
            }

            form textarea {
                padding: 10px;
                resize: none;
                border: 1px solid #ccc;
            }

            form input {
                padding: 10px;
                border: 1px solid #ccc;
            }

            .form-details label {
                margin-top: 10px;
                width: 200px;
                font-weight: bolder;
            }

            input[type="text"],
            input[type="number"] {
                margin-top: 10px;
                width: 200px;
                font-weight: normal;
            }

            .form-details label[for="nombre"],
            input[id="nombre"] {
                width: 95%;
            }


            .form-detail-product__img {
                min-width: 400px;
                width: 100%;

            }

            .form-detail-product {
                position: relative;
                display: inline;
                width: 100%;
                min-width: 400px;
                padding: 10px;
                height: inherit;
            }

            .form-detail-product__footer {
                display: inline;
                width: 100%;
                min-width: 400px;
                padding: 10px;
            }

            .form-detail-product__footer input[type="submit"] {
                width: 100%;
                border: none;
                border-radius: 5px;
                padding: 15px;
                color: white;
                background-color: black;
                opacity: .8;
            }

            .form-detail-product__footer input[type="submit"]:hover {
                opacity: .7;
            }

            .form-detail-product__footer input[type="submit"]:active {
                padding: 15px;
                opacity: .6;
                cursor: pointer;
                z-index: 1;
            }

            .form-detail-product__footer button {
                width: 100%;
                border: none;
                border-radius: 5px;
                padding: 15px;
                color: white;
                background-color: rgb(218, 61, 87);
            }

            .form-detail-product__footer button:hover {
                opacity: .7;
            }

            .form-detail-product__footer button:active {
                opacity: .5;
            }
        </style>
        <div class="paginator">
            <div class="wrapper-paginator">
                <button class="paginator_btn__nextpage glyphicon glyphicon-step-backward" action="step-backward">
                </button>
                <button class="paginator_btn__nextpage glyphicon glyphicon-backward" action="backward">
                </button>
                <button class="paginator_btn__page glyphicon" action="page1">1</button>
                <button class="paginator_btn__page glyphicon" action="page2">2</button>
                <button class="paginator_btn__page glyphicon" action="page3">3</button>
                <button class="paginator_btn__page glyphicon" action="page4">4</button>
                <button class="paginator_btn__backpage glyphicon glyphicon-forward" action="forward">
                    <span class=""></span>
                </button>
                <button class="paginator_btn__backpage glyphicon glyphicon-step-forward" action="step-forward">
                </button>
            </div>
        </div>
    </section>
    <script>
        let data_funko = [];

        let selectedRow = undefined;
        HEADERS = ['id', 'nombre', 'descripcion', 'precio', 'stock'];


        let TABLE = document.querySelector('table');
        let TBODY = document.querySelector('tbody');
        let trIronman = TBODY.querySelector('.ironman');

        // Id del objeto y posicion, al ultimo renderizas el formulario.
        let form = document.querySelector('.form-details');
        let div = document.querySelector('.form-detail-product__footer');
        // let input = div.querySelector('input');
        // console.log(input);

        // Programacion asyncrona a futuro:
        form.addEventListener('submit', (e) => {
            e.preventDefault();
            let data = Object.fromEntries(new FormData(e.target));
            console.log(data);
            form.reset();
        });

        TBODY.addEventListener('mouseover', (e) => {
            let elementHTLM = getElementHTML(e);
            if (elementHTLM.tagName === "TD") {
                let row = getParent(elementHTLM);
                row.setAttribute('class', 'row-style');
            }
        });

        TBODY.addEventListener('mouseout', (e) => {
            let elementHTLM = getElementHTML(e);
            if (elementHTLM.tagName === "TD") {
                let row = getParent(elementHTLM);
                row.removeAttribute('class');
            }
        });


        TBODY.addEventListener('click', (e) => {
            // e.stopPropagation();
            e.preventDefault();
            let elementHTML = e.target;

            let tdElement = undefined;
            let rowElement = undefined;

            // Si haces click sobre TD solo subes un nivel:
            if (elementHTML.tagName === "I" || elementHTML.tagName === "TD") {
                if (elementHTML.tagName === "I") {
                    tdElement = getParent(elementHTML);
                    rowElement = getParent(tdElement);
                } else {
                    rowElement = getParent(elementHTML);
                }

                let data = extractRowData(rowElement);
                selectedRow = data;
                inyectDataToForm();
            }
        });

        function getParent(elementHMTL) {
            return elementHMTL.parentNode;
        }

        function getElementHTML(e) {
            return e.target;
        }

        function extractRowData(row) {
            //Estado original: Extrae los datos de las celdas de una fila y lo convierte en un objeto
            let values = row.children;
            let dataRow = {};

            for (let key of HEADERS) {
                dataRow[key] = values[key].innerText;
            }
            return dataRow;
        }

        function inyectDataToForm() {
            if (!selectedRow) {
                return 'no data available';
            }

            let editNombre = form['nombre'];
            let editDescripcion = form['descripcion'];
            let editPrecio = form['precio'];
            let editDivisa = form['divisa'];
            let editStock = form['stock'];

            editNombre.value = selectedRow.nombre;
            editDescripcion.value = selectedRow.descripcion;
            editPrecio.value = selectedRow.precio;
            // editDivisa.value = selectedRow.divisa;
            editStock.value = selectedRow.stock;
        }

        function renderizarForm() {

        }

        // let row5 = document.querySelector('.simulate-action');
        // row5.dispatchEvent(new Event('click', { bubbles: true }));

        // input.dispatchEvent(new Event('submit'));
    </script>
</body>

</html>